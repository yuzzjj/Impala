====
---- QUERY: TPCDS-Q27
# TODO: Fix this query up when rollup is implemented
select
  i_item_id,
  s_state,
  -- grouping(s_state) g_state,
  avg(ss_quantity) agg1,
  avg(ss_list_price) agg2,
  avg(ss_coupon_amt) agg3,
  avg(ss_sales_price) agg4
from
  store_sales,
  customer_demographics,
  date_dim,
  store,
  item
where
  ss_sold_date_sk = d_date_sk
  and ss_item_sk = i_item_sk
  and ss_store_sk = s_store_sk
  and ss_cdemo_sk = cd_demo_sk
  and cd_gender = 'M'
  and cd_marital_status = 'S'
  and cd_education_status = 'College'
  and d_year = 2002
  and s_state in ('TN','TN', 'TN', 'TN', 'TN', 'TN')
group by
  -- rollup (i_item_id, s_state),
  i_item_id,
  s_state
order by
  i_item_id,
  s_state
limit 100;
---- RESULTS
'AAAAAAAAAAABAAAA','TN',46,114.72,0.00,32.12
'AAAAAAAAAAAEAAAA','TN',100,77.97,0.00,57.69
'AAAAAAAAAABAAAAA','TN',6,48.89,13.61,2.44
'AAAAAAAAAACAAAAA','TN',62,32.21,0.00,5.50
'AAAAAAAAAACDAAAA','TN',97,161.78,0.00,55.00
'AAAAAAAAAADBAAAA','TN',28,136.01,575.76,73.44
'AAAAAAAAAADCAAAA','TN',64,116.14,0.00,108.01
'AAAAAAAAAAEBAAAA','TN',9,5.43,0.00,5.21
'AAAAAAAAAAEDAAAA','TN',45.5,87.63,0.00,51.84
'AAAAAAAAAAGBAAAA','TN',29,101.94,0.00,100.92
'AAAAAAAAAAGCAAAA','TN',97,65.27,0.00,21.53
'AAAAAAAAAAGEAAAA','TN',55,73.87,0.00,71.00
'AAAAAAAAAAHAAAAA','TN',20,134.30,0.00,119.52
'AAAAAAAAAAHBAAAA','TN',97,7.40,0.00,6.73
'AAAAAAAAAAHDAAAA','TN',69,5.62,0.00,0.33
'AAAAAAAAAAIAAAAA','TN',87,106.98,0.00,27.81
'AAAAAAAAAAKBAAAA','TN',84.5,66.17,847.83,57.38
'AAAAAAAAAALAAAAA','TN',6,32.28,0.00,7.42
'AAAAAAAAAALCAAAA','TN',98,34.31,55.30,1.71
'AAAAAAAAAALDAAAA','TN',59,129.47,713.90,22.00
'AAAAAAAAAANAAAAA','TN',74,60.87,0.00,13.20
'AAAAAAAAAANBAAAA','TN',96,130.79,1864.51,129.48
'AAAAAAAAAAOAAAAA','TN',85,130.34,0.00,122.51
'AAAAAAAAAAOCAAAA','TN',14,64.57,0.00,33.97
'AAAAAAAAAAODAAAA','TN',84,30.50,0.00,28.97
'AAAAAAAAAAPBAAAA','TN',45,118.89,2380.59,84.71
'AAAAAAAAABAAAAAA','TN',97,124.75,0.00,74.85
'AAAAAAAAABABAAAA','TN',31,29.98,17.09,27.58
'AAAAAAAAABAEAAAA','TN',34,17.21,0.00,13.42
'AAAAAAAAABCBAAAA','TN',38,131.37,0.00,52.32
'AAAAAAAAABDAAAAA','TN',31.5,68.34,0.00,63.27
'AAAAAAAAABDBAAAA','TN',56,103.85,1624.17,59.19
'AAAAAAAAABDDAAAA','TN',67.33333333333333,119.42,23.18,38.72
'AAAAAAAAABDEAAAA','TN',61,85.95,2282.36,44.60
'AAAAAAAAABEDAAAA','TN',61,85.14,0.00,50.23
'AAAAAAAAABFBAAAA','TN',31,23.55,0.00,13.65
'AAAAAAAAABFCAAAA','TN',83,15.50,0.00,0.00
'AAAAAAAAABGAAAAA','TN',64,35.08,0.00,3.15
'AAAAAAAAABGBAAAA','TN',40,25.07,0.00,16.04
'AAAAAAAAABGEAAAA','TN',39.5,56.76,14.25,36.00
'AAAAAAAAABHAAAAA','TN',93,74.80,0.00,21.69
'AAAAAAAAABHCAAAA','TN',31.5,79.83,181.38,61.93
'AAAAAAAAABIBAAAA','TN',48,170.89,0.00,140.12
'AAAAAAAAABJAAAAA','TN',46.5,82.32,0.00,44.98
'AAAAAAAAABJBAAAA','TN',76,12.40,0.00,3.96
'AAAAAAAAABJDAAAA','TN',34,118.50,0.00,61.20
'AAAAAAAAABKAAAAA','TN',65,8.77,0.00,5.18
'AAAAAAAAABKCAAAA','TN',26,51.57,0.00,41.25
'AAAAAAAAABLBAAAA','TN',61.5,149.12,0.00,82.54
'AAAAAAAAABMAAAAA','TN',14,109.97,0.00,10.99
'AAAAAAAAABMDAAAA','TN',97,104.87,0.00,34.60
'AAAAAAAAABNAAAAA','TN',13.5,17.39,0.00,2.02
'AAAAAAAAABOBAAAA','TN',66,112.86,0.00,24.82
'AAAAAAAAABPAAAAA','TN',19,67.33,268.60,16.83
'AAAAAAAAABPDAAAA','TN',37,41.16,0.00,20.22
'AAAAAAAAACACAAAA','TN',53,132.50,0.00,15.90
'AAAAAAAAACADAAAA','TN',73,76.59,782.56,21.44
'AAAAAAAAACBBAAAA','TN',82,75.22,277.55,10.24
'AAAAAAAAACBCAAAA','TN',53,35.46,0.00,21.98
'AAAAAAAAACBEAAAA','TN',49,113.20,1902.14,75.14
'AAAAAAAAACCAAAAA','TN',60,111.87,0.00,74.95
'AAAAAAAAACCEAAAA','TN',89,73.99,0.00,4.43
'AAAAAAAAACDAAAAA','TN',35,86.57,0.00,22.63
'AAAAAAAAACDCAAAA','TN',30,68.03,0.00,55.59
'AAAAAAAAACDDAAAA','TN',67.66666666666667,21.32,0.00,7.83
'AAAAAAAAACEBAAAA','TN',69.5,81.94,0.00,29.79
'AAAAAAAAACECAAAA','TN',89,47.10,0.00,20.72
'AAAAAAAAACFBAAAA','TN',70,14.60,0.00,8.46
'AAAAAAAAACFDAAAA','TN',53,106.16,0.00,91.29
'AAAAAAAAACFEAAAA','TN',40.33333333333334,103.41,0.00,18.00
'AAAAAAAAACGAAAAA','TN',41,10.00,0.00,6.70
'AAAAAAAAACGDAAAA','TN',4,6.32,0.00,3.72
'AAAAAAAAACHBAAAA','TN',51,67.85,1521.28,54.99
'AAAAAAAAACHCAAAA','TN',4,101.18,0.00,97.13
'AAAAAAAAACKBAAAA','TN',96,123.44,0.00,122.20
'AAAAAAAAACKCAAAA','TN',44,48.71,0.00,23.86
'AAAAAAAAACLDAAAA','TN',50,130.80,0.00,13.08
'AAAAAAAAACMDAAAA','TN',33,91.53,0.00,71.39
'AAAAAAAAACNCAAAA','TN',27,69.84,0.00,27.93
'AAAAAAAAACODAAAA','TN',54,57.73,0.00,7.78
'AAAAAAAAACPAAAAA','TN',36,103.03,0.00,97.87
'AAAAAAAAADABAAAA','TN',20,194.76,0.00,5.84
'AAAAAAAAADAEAAAA','TN',53,65.66,0.00,53.84
'AAAAAAAAADBAAAAA','TN',48,87.49,0.00,74.79
'AAAAAAAAADBBAAAA','TN',88,48.86,0.00,9.77
'AAAAAAAAADBDAAAA','TN',41,27.62,380.27,13.25
'AAAAAAAAADBEAAAA','TN',33.5,112.42,0.00,55.36
'AAAAAAAAADCAAAAA','TN',59,5.43,0.00,4.88
'AAAAAAAAADDBAAAA','TN',25,149.67,0.00,125.72
'AAAAAAAAADDEAAAA','TN',54,11.80,0.00,8.26
'AAAAAAAAADEAAAAA','TN',23,132.68,0.00,30.51
'AAAAAAAAADEDAAAA','TN',99,48.89,0.00,48.89
'AAAAAAAAADFAAAAA','TN',67.5,45.22,0.00,19.09
'AAAAAAAAADFCAAAA','TN',77,101.79,0.00,39.69
'AAAAAAAAADFDAAAA','TN',94,79.82,414.86,63.05
'AAAAAAAAADGCAAAA','TN',19,14.27,0.00,5.56
'AAAAAAAAADGEAAAA','TN',75.66666666666667,123.31,413.13,51.38
'AAAAAAAAADHBAAAA','TN',15,179.13,496.44,39.40
'AAAAAAAAADHDAAAA','TN',98,39.30,0.00,33.79
'AAAAAAAAADIAAAAA','TN',27,124.51,0.00,107.07
---- TYPES
STRING, STRING, DOUBLE, DECIMAL, DECIMAL, DECIMAL
====