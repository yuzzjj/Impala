====
---- QUERY: TPCH-Q9
# Q9 - Product Type Measure Query
select
  nation,
  o_year,
  round(sum(amount), 2) as sum_profit
from(
  select
    n_name as nation,
    year(o_orderdate) as o_year,
    round(l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity, 2) as amount
  from
    part,
    supplier,
    lineitem,
    partsupp,
    orders,
    nation
  where
    s_suppkey = l_suppkey
    and ps_suppkey = l_suppkey
    and ps_partkey = l_partkey
    and p_partkey = l_partkey
    and o_orderkey = l_orderkey
    and s_nationkey = n_nationkey
    and p_name like '%green%'
  ) as profit
group by
  nation,
  o_year
order by
  nation,
  o_year desc
---- RESULTS
'ALGERIA',1998,27136900.28
'ALGERIA',1997,48611833.43
'ALGERIA',1996,48285482.72
'ALGERIA',1995,44402273.75
'ALGERIA',1994,48694008.05
'ALGERIA',1993,46044207.83
'ALGERIA',1992,45636849.53
'ARGENTINA',1998,28341663.78
'ARGENTINA',1997,47143964.27
'ARGENTINA',1996,45255278.67
'ARGENTINA',1995,45631769.29
'ARGENTINA',1994,48268856.35
'ARGENTINA',1993,48605593.59
'ARGENTINA',1992,46654240.88
'BRAZIL',1998,26527736.60
'BRAZIL',1997,45640660.78
'BRAZIL',1996,45090647.16
'BRAZIL',1995,44015888.61
'BRAZIL',1994,44854219.18
'BRAZIL',1993,45766603.83
'BRAZIL',1992,45280217.03
'CANADA',1998,26828985.41
'CANADA',1997,44849954.37
'CANADA',1996,46307936.30
'CANADA',1995,47311993.22
'CANADA',1994,46691492.14
'CANADA',1993,46634791.12
'CANADA',1992,45873849.65
'CHINA',1998,27510180.35
'CHINA',1997,46123865.57
'CHINA',1996,49532807.30
'CHINA',1995,46734651.69
'CHINA',1994,46397896.61
'CHINA',1993,49634674.15
'CHINA',1992,46949457.76
'EGYPT',1998,28401491.73
'EGYPT',1997,47674857.92
'EGYPT',1996,47745727.75
'EGYPT',1995,45897160.80
'EGYPT',1994,47194895.49
'EGYPT',1993,49133627.89
'EGYPT',1992,47000574.63
'ETHIOPIA',1998,25135046.16
'ETHIOPIA',1997,43010596.18
'ETHIOPIA',1996,43636287.12
'ETHIOPIA',1995,43575757.53
'ETHIOPIA',1994,41597208.56
'ETHIOPIA',1993,42622804.38
'ETHIOPIA',1992,44385735.82
'FRANCE',1998,26210392.43
'FRANCE',1997,42392969.67
'FRANCE',1996,43306318.11
'FRANCE',1995,46377408.57
'FRANCE',1994,43447353.27
'FRANCE',1993,43729961.17
'FRANCE',1992,44052308.28
'GERMANY',1998,25991257.35
'GERMANY',1997,43968355.88
'GERMANY',1996,45882074.92
'GERMANY',1995,43314338.22
'GERMANY',1994,44616995.42
'GERMANY',1993,45126646.10
'GERMANY',1992,44361141.24
'INDIA',1998,29626417.37
'INDIA',1997,51386111.45
'INDIA',1996,47571018.40
'INDIA',1995,49344062.66
'INDIA',1994,50106952.51
'INDIA',1993,48112766.93
'INDIA',1992,47914303.24
'INDONESIA',1998,27734909.82
'INDONESIA',1997,44593813.16
'INDONESIA',1996,44746730.00
'INDONESIA',1995,45593622.88
'INDONESIA',1994,45988483.99
'INDONESIA',1993,46147963.85
'INDONESIA',1992,45185777.26
'IRAN',1998,26661609.15
'IRAN',1997,45019114.34
'IRAN',1996,45891397.36
'IRAN',1995,44414285.20
'IRAN',1994,43696360.46
'IRAN',1993,45362775.84
'IRAN',1992,43052338.57
'IRAQ',1998,31188498.22
'IRAQ',1997,48585307.79
'IRAQ',1996,50036593.96
'IRAQ',1995,48774801.92
'IRAQ',1994,48795847.42
'IRAQ',1993,47435691.62
'IRAQ',1992,47562355.64
'JAPAN',1998,24694102.28
'JAPAN',1997,42377052.33
'JAPAN',1996,40267778.92
'JAPAN',1995,40925317.74
'JAPAN',1994,41159518.59
'JAPAN',1993,39589074.40
'JAPAN',1992,39113494.09
'JORDAN',1998,23489867.79
'JORDAN',1997,41615962.72
'JORDAN',1996,41860855.56
'JORDAN',1995,39931672.03
'JORDAN',1994,40707555.57
'JORDAN',1993,39060405.72
'JORDAN',1992,41657604.23
'KENYA',1998,25566337.53
'KENYA',1997,43108847.87
'KENYA',1996,43482953.61
'KENYA',1995,42517989.18
'KENYA',1994,43612479.34
'KENYA',1993,42724038.88
'KENYA',1992,43217106.33
'MOROCCO',1998,24915497.00
'MOROCCO',1997,42698383.09
'MOROCCO',1996,42986113.41
'MOROCCO',1995,42316089.25
'MOROCCO',1994,43458604.84
'MOROCCO',1993,42672288.09
'MOROCCO',1992,42800781.57
'MOZAMBIQUE',1998,28279875.98
'MOZAMBIQUE',1997,51159216.31
'MOZAMBIQUE',1996,48072525.21
'MOZAMBIQUE',1995,48905200.82
'MOZAMBIQUE',1994,46092076.35
'MOZAMBIQUE',1993,48555926.23
'MOZAMBIQUE',1992,47809075.36
'PERU',1998,26713966.40
'PERU',1997,48324008.57
'PERU',1996,50310008.87
'PERU',1995,49647080.89
'PERU',1994,46420910.15
'PERU',1993,51536906.45
'PERU',1992,47711665.28
'ROMANIA',1998,27271992.98
'ROMANIA',1997,45063059.33
'ROMANIA',1996,47492335.15
'ROMANIA',1995,45710636.24
'ROMANIA',1994,46088041.34
'ROMANIA',1993,47515092.77
'ROMANIA',1992,44111439.92
'RUSSIA',1998,27935323.85
'RUSSIA',1997,48222347.45
'RUSSIA',1996,47553559.65
'RUSSIA',1995,46755990.02
'RUSSIA',1994,48000515.83
'RUSSIA',1993,48569624.74
'RUSSIA',1992,47672831.69
'SAUDI ARABIA',1998,27113517.02
'SAUDI ARABIA',1997,46690468.87
'SAUDI ARABIA',1996,47775782.69
'SAUDI ARABIA',1995,46657107.96
'SAUDI ARABIA',1994,48181673.14
'SAUDI ARABIA',1993,45692556.61
'SAUDI ARABIA',1992,48924913.28
'UNITED KINGDOM',1998,26366682.81
'UNITED KINGDOM',1997,44518130.03
'UNITED KINGDOM',1996,45539729.78
'UNITED KINGDOM',1995,46845879.42
'UNITED KINGDOM',1994,43081609.54
'UNITED KINGDOM',1993,44770147.00
'UNITED KINGDOM',1992,44123402.78
'UNITED STATES',1998,27826593.86
'UNITED STATES',1997,46638572.34
'UNITED STATES',1996,46688280.64
'UNITED STATES',1995,48951591.81
'UNITED STATES',1994,45099091.90
'UNITED STATES',1993,46181600.58
'UNITED STATES',1992,46168214.21
'VIETNAM',1998,27281931.07
'VIETNAM',1997,48735914.28
'VIETNAM',1996,47824596.08
'VIETNAM',1995,48235136.01
'VIETNAM',1994,47729256.41
'VIETNAM',1993,45352677.14
'VIETNAM',1992,47846355.72
---- TYPES
STRING, INT, DOUBLE
====